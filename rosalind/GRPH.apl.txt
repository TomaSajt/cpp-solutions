
names{↑↑,/{((⊃1↑⍵),' ',⊢)¨⊃⌽⍵}¨({0≠≢⊃⌽⍵}¨⊢⍤/⊢)↓⍺(,⍤0)⍺∘{⍺⌷⍨⊂⍸⍵}¨↓∘.{((⊃⌽⍺)=⊃⍵)∧⍺≢⍵}⍨⍵}strings