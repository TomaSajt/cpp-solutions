{∪⊃,/{↓∘⍵¨⎕IO-⍨⍸'M'=⍵}¨⊃,/({~'.'=⍵}⊆⊢)¨({table⌷⍨'TCAG'⍳⍵}⍤1{3,⍨⌊3÷⍨≢⍵}⍴⊢)¨⊃,/{(2↓⍵)(1↓⍵)⍵}¨({'TAGC'⌷⍨⊂'ATCG'⍳⌽⍵},⍥⊂⊢)⍵}