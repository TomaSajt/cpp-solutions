4∘{+/⍤⍷∘⍵¨⍺∘{'ACGT'⌷⍨⊂⎕IO+(-⍺)↑4(⊥⍣¯1)⍵}¨⎕IO-⍨⍳4*⍺}